# Исправление обработки статусов Bliss

## Найденная проблема

В выгрузках Bliss встречаются различные статусы ордеров, но система обрабатывала только часть из них:
- **Success** ✅ → `filled`
- **Cancelled** ✅ → `canceled`
- **Pending** ✅ → `pending`
- **Expired** ❌ → `filled` (неправильно)
- **Failed** ❌ → `filled` (неправильно)

Статусы `Expired` и `Failed` неправильно переводились в `filled` (успешный), что искажало отчетность.

## Что исправлено

### 1. Парсер файлов Bliss (`app.py`)
Добавлена обработка новых статусов:
```python
elif 'Expired' in col_value or 'expired' in col_value:
    status = 'expired'
elif 'Failed' in col_value or 'failed' in col_value:
    status = 'failed'
```

### 2. Интерфейс (`templates/index.html`)
Добавлена поддержка новых статусов:
- **Цвета статусов**: `expired` - оранжевый, `failed` - темно-красный
- **Текст статусов**: `expired` - "Истек", `failed` - "Неуспешен"
- **Фильтры**: новые статусы доступны в выпадающих списках

### 3. API фильтрация
Обновлена логика исключения неуспешных ордеров:
```python
# Исключаем отмененные и неуспешные ордера
query = query.filter(~Order.status.in_(['canceled', 'expired', 'failed']))
```

## Результат

### ✅ Теперь все статусы обрабатываются корректно:
- **Success** → `filled` (Завершен) - зеленый
- **Expired** → `expired` (Истек) - оранжевый
- **Failed** → `failed` (Неуспешен) - темно-красный
- **Cancelled** → `canceled` (Отменен) - красный
- **Pending** → `pending` (В ожидании) - желтый

### ✅ Улучшенная фильтрация:
- При просмотре ордеров по умолчанию скрываются неуспешные ордера (`canceled`, `expired`, `failed`)
- Можно фильтровать по конкретным статусам через выпадающий список
- Статистика теперь учитывает корректные статусы

## Совместимость

Изменения полностью обратно совместимы:
- Существующие ордера не затронуты
- Старые файлы будут обработаны с новой логикой
- Все платформы (Bybit, HTX, Gate.io) работают как раньше

## Как проверить

1. Загрузите выгрузку Bliss с различными статусами
2. В интерфейсе увидите корректные статусы с соответствующими цветами
3. Фильтры будут работать с новыми статусами
4. Отчеты будут показывать реальную картину (без учета неуспешных ордеров)

Теперь система Bliss корректно обрабатывает все возможные статусы ордеров! 